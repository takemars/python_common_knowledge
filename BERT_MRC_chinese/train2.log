nohup: ignoring input
2022-03-26 22:28:20.877583: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-03-26 22:28:20.877641: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Namespace(bert_model='./pretrained_model/hfl_chinese-roberta-wwm-ext/', checkpoint=500, clip_grad=1, config_path='./pretrained_model/hfl_chinese-roberta-wwm-ext/config.json', data_cache=True, data_dir='./data/zh_msra/', data_sign='MSRA', dev_batch_size=16, device=device(type='cuda', index=0), dropout=0.2, entity_sign='flat', entity_threshold=0.5, export_model=True, gradient_accumulation_steps=1, hidden_size=768, learning_rate=5e-05, local_rank=-1, max_seq_length=256, n_gpu=1, num_train_epochs=10, output_dir='./output', saved_model='bert_finetune_model_v2.bin', seed=2333, task_name=None, test_batch_size=2, train_batch_size=32, warmup_proportion=0.1, weight_end=1.0, weight_span=1.0, weight_start=1.0)
Some weights of the model checkpoint at ./pretrained_model/hfl_chinese-roberta-wwm-ext/ were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  0
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:0/10 step:500/24456 loss:0.013706519268453121
............................................................
DEV: loss, acc, precision, recall, f1
0.0082 0.6863 0.7328 0.5329 0.6171
SAVED model path is :
./output/bert_finetune_model_v2.bin
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
Best DEV : overall best loss, acc, precision, recall, f1 
0.0082 0.6863 0.7328 0.5329 0.6171
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:0/10 step:1000/24456 loss:0.0021709753200411797
............................................................
DEV: loss, acc, precision, recall, f1
0.0029 0.8869 0.9363 0.8433 0.8873
SAVED model path is :
./output/bert_finetune_model_v2.bin
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
Best DEV : overall best loss, acc, precision, recall, f1 
0.0029 0.8869 0.9363 0.8433 0.8873
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:0/10 step:1500/24456 loss:0.0018589422106742859
............................................................
DEV: loss, acc, precision, recall, f1
0.0029 0.8888 0.8941 0.9019 0.898
SAVED model path is :
./output/bert_finetune_model_v2.bin
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
Best DEV : overall best loss, acc, precision, recall, f1 
0.0029 0.8888 0.8941 0.9019 0.898
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:0/10 step:2000/24456 loss:0.0037061399780213833
............................................................
DEV: loss, acc, precision, recall, f1
0.0023 0.9039 0.9187 0.8993 0.9089
SAVED model path is :
./output/bert_finetune_model_v2.bin
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
Best DEV : overall best loss, acc, precision, recall, f1 
0.0023 0.9039 0.9187 0.8993 0.9089
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  1
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:1/10 step:2500/24456 loss:0.000958337914198637
............................................................
DEV: loss, acc, precision, recall, f1
0.0023 0.9186 0.952 0.8918 0.9209
SAVED model path is :
./output/bert_finetune_model_v2.bin
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
Best DEV : overall best loss, acc, precision, recall, f1 
0.0023 0.9186 0.952 0.8918 0.9209
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:1/10 step:3000/24456 loss:0.0008068890310823917
............................................................
DEV: loss, acc, precision, recall, f1
0.0021 0.9175 0.9486 0.908 0.9279
SAVED model path is :
./output/bert_finetune_model_v2.bin
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
Best DEV : overall best loss, acc, precision, recall, f1 
0.0021 0.9175 0.9486 0.908 0.9279
=&==&==&==&==&==&==&==&==&==&==&==&==&==&==&=
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:1/10 step:3500/24456 loss:0.00026867768610827625
............................................................
DEV: loss, acc, precision, recall, f1
0.0024 0.9042 0.9176 0.9014 0.9094
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:1/10 step:4000/24456 loss:1.6060881534940563e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0023 0.9142 0.9319 0.9148 0.9233
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:1/10 step:4500/24456 loss:5.7197372370865196e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0025 0.9124 0.9268 0.9113 0.919
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  2
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:2/10 step:5000/24456 loss:0.0016069214325398207
............................................................
DEV: loss, acc, precision, recall, f1
0.0024 0.9079 0.9175 0.9261 0.9218
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:2/10 step:5500/24456 loss:1.711391087155789e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0024 0.9171 0.9343 0.9139 0.924
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:2/10 step:6000/24456 loss:0.0014298008754849434
............................................................
DEV: loss, acc, precision, recall, f1
0.0025 0.9161 0.9328 0.9172 0.9249
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:2/10 step:6500/24456 loss:8.825144323054701e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0024 0.9149 0.9372 0.9099 0.9234
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:2/10 step:7000/24456 loss:2.6445989078638377e-06
............................................................
DEV: loss, acc, precision, recall, f1
0.003 0.9089 0.9219 0.9106 0.9162
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  3
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:3/10 step:7500/24456 loss:2.8532933356473222e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0032 0.9137 0.9324 0.9125 0.9223
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:3/10 step:8000/24456 loss:0.0007956181070767343
............................................................
DEV: loss, acc, precision, recall, f1
0.0026 0.9219 0.9385 0.9115 0.9248
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:3/10 step:8500/24456 loss:0.002894049510359764
............................................................
DEV: loss, acc, precision, recall, f1
0.0035 0.9002 0.9026 0.8958 0.8991
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:3/10 step:9000/24456 loss:0.0004826397052966058
............................................................
DEV: loss, acc, precision, recall, f1
0.0033 0.9122 0.9351 0.9054 0.92
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:3/10 step:9500/24456 loss:1.4467552318819799e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0029 0.9194 0.9518 0.896 0.923
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  4
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:4/10 step:10000/24456 loss:0.0013006394729018211
............................................................
DEV: loss, acc, precision, recall, f1
0.0026 0.9198 0.9399 0.9092 0.9243
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:4/10 step:10500/24456 loss:6.151745765237138e-06
............................................................
DEV: loss, acc, precision, recall, f1
0.0034 0.9134 0.9311 0.9165 0.9238
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:4/10 step:11000/24456 loss:3.141912748105824e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0032 0.901 0.9094 0.9167 0.9131
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:4/10 step:11500/24456 loss:0.00013818743173033
............................................................
DEV: loss, acc, precision, recall, f1
0.0029 0.9055 0.9051 0.9249 0.9149
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:4/10 step:12000/24456 loss:0.0007971902959980071
............................................................
DEV: loss, acc, precision, recall, f1
0.0034 0.9115 0.9132 0.9134 0.9133
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  5
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:5/10 step:12500/24456 loss:0.002132144756615162
............................................................
DEV: loss, acc, precision, recall, f1
0.0038 0.9164 0.9263 0.9193 0.9228
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:5/10 step:13000/24456 loss:0.0006832198123447597
............................................................
DEV: loss, acc, precision, recall, f1
0.0032 0.9026 0.9303 0.9007 0.9152
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:5/10 step:13500/24456 loss:0.00041276472620666027
............................................................
DEV: loss, acc, precision, recall, f1
0.0036 0.9145 0.9356 0.9059 0.9205
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:5/10 step:14000/24456 loss:7.190543328761123e-06
............................................................
DEV: loss, acc, precision, recall, f1
0.0034 0.91 0.9232 0.9075 0.9153
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:5/10 step:14500/24456 loss:2.591719021438621e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.003 0.9126 0.9075 0.9299 0.9185
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  6
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:6/10 step:15000/24456 loss:0.0014848801074549556
............................................................
DEV: loss, acc, precision, recall, f1
0.0042 0.9087 0.9496 0.8769 0.9118
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:6/10 step:15500/24456 loss:0.0017241148743778467
............................................................
DEV: loss, acc, precision, recall, f1
0.0037 0.9177 0.9306 0.9092 0.9198
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:6/10 step:16000/24456 loss:3.1644445698475465e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0035 0.9179 0.9362 0.9082 0.922
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:6/10 step:16500/24456 loss:0.0005809402791783214
............................................................
DEV: loss, acc, precision, recall, f1
0.0037 0.9143 0.9206 0.9118 0.9162
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:6/10 step:17000/24456 loss:1.4625870790041517e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0036 0.9145 0.909 0.9311 0.9199
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  7
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:7/10 step:17500/24456 loss:3.4193595638498664e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0034 0.9127 0.9214 0.9181 0.9197
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:7/10 step:18000/24456 loss:5.575938121182844e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0026 0.9187 0.9235 0.9092 0.9163
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:7/10 step:18500/24456 loss:6.39387289993465e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0034 0.9154 0.9369 0.9042 0.9203
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:7/10 step:19000/24456 loss:8.187095772882458e-06
............................................................
DEV: loss, acc, precision, recall, f1
0.0032 0.9159 0.9175 0.9158 0.9166
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:7/10 step:19500/24456 loss:0.0012316100765019655
............................................................
DEV: loss, acc, precision, recall, f1
0.0032 0.9203 0.9408 0.9089 0.9246
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  8
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:8/10 step:20000/24456 loss:3.263231337768957e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0041 0.9104 0.937 0.8885 0.9121
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:8/10 step:20500/24456 loss:9.005319589050487e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0033 0.9176 0.9458 0.9066 0.9258
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:8/10 step:21000/24456 loss:0.00020430138101801276
............................................................
DEV: loss, acc, precision, recall, f1
0.0033 0.919 0.933 0.9176 0.9253
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:8/10 step:21500/24456 loss:5.096355016576126e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0038 0.9062 0.9055 0.9085 0.907
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:8/10 step:22000/24456 loss:7.432154234265909e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0035 0.9139 0.923 0.9162 0.9196
-*--*--*--*--*--*--*--*--*--*-
current data_sign: MSRA
=*==*==*==*==*==*==*==*==*==*=
loading train data ... ...
78261
78261 train data loaded
=*==*==*==*==*==*==*==*==*==*=
loading dev data ... ...
6174
6174 dev data loaded
=*==*==*==*==*==*==*==*==*==*=
loading test data ... ...
7197
7197 test data loaded
######################################################################
EPOCH:  9
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:9/10 step:22500/24456 loss:5.818889803776983e-06
............................................................
DEV: loss, acc, precision, recall, f1
0.0037 0.9184 0.9376 0.9045 0.9207
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:9/10 step:23000/24456 loss:8.466745202895254e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.0033 0.917 0.9268 0.9176 0.9222
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:9/10 step:23500/24456 loss:1.684016388026066e-05
............................................................
DEV: loss, acc, precision, recall, f1
0.004 0.9098 0.9285 0.9071 0.9176
-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*-
【train】 epoch:9/10 step:24000/24456 loss:8.894020538718905e-06
............................................................
DEV: loss, acc, precision, recall, f1
0.0034 0.9114 0.9387 0.9047 0.9214
